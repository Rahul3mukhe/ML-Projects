# -*- coding: utf-8 -*-
"""Mall_Customer_Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JLelQzoPj2ZaxLaVfmnu0QvGryZTnRp6
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv('/content/Mall_Customers.csv')

df

df.isnull().sum()

sns.heatmap(df.isnull(),cmap = 'viridis')

sns.boxplot(data=df[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']])
plt.show()

sns.pairplot(df, hue="Gender")
plt.show()

plt.figure(figsize=(6, 4))
sns.countplot(x='Gender', data=df)
plt.title('Gender Distribution')
plt.show()

gender_mapping = {'Male': 0, 'Female': 1}
df['Gender'] = df['Gender'].map(gender_mapping)

from sklearn.cluster import KMeans
from sklearn import preprocessing
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
numerical_cols = ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']
df[numerical_cols] = scaler.fit_transform(df[numerical_cols])

kmeans = KMeans(n_clusters=5, random_state=42) # Choose n_clusters based on EDA
df['cluster'] = kmeans.fit_predict(df[numerical_cols + ['Gender']])

plt.figure(figsize=(8, 6))
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', hue='cluster', data=df, palette='viridis')
plt.title('K-Means Clustering')
plt.show()

from sklearn.cluster import AgglomerativeClustering
import scipy.cluster.hierarchy as shc

X = df[numerical_cols + ['Gender']]
plt.figure(figsize=(10, 7))
plt.title("Customer Dendograms")
dend = shc.dendrogram(shc.linkage(X, method='ward'))  # 'ward' is generally a good choice
plt.show()

